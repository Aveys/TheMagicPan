<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:h="http://java.sun.com/jsf/html" xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:c="http://java.sun.com/jsp/jstl/core" xmlns:a="http://xmlns.jcp.org/jsf/passthrough"
                xmlns:f="http://xmlns.jcp.org/jsf/core" xmlns:p="http://primefaces.org/ui">
    <div class="container">
        <h:form id="form">
            <p:outputPanel styleClass="recipeTitle">
                <h:outputText value="#{recipeControlerBean.recipe.title}"/>
            </p:outputPanel>
            <p:outputPanel styleClass="recipeInfo">
                <h:outputText value="#{recipeControlerBean.recipe.type}"/>
            </p:outputPanel>
            <p:outputPanel styleClass="recipeInfo">
                <h:outputText value="#{recipeControlerBean.recipe.time}"/>
            </p:outputPanel>
            <p:outputPanel styleClass="recipeInfo">
                <h:outputText value="#{recipeControlerBean.recipe.note}"/>
            </p:outputPanel>
            <p:outputPanel styleClass="recipeInfo">
                <h:outputText value="#{recipeControlerBean.recipe.nbServings}"/>
            </p:outputPanel>
            <p:outputPanel styleClass="recipeDesc">
                <h:outputText value="#{recipeControlerBean.recipe.description}"/>
            </p:outputPanel>

            <p:outputPanel id="recipeImg">
                <h:outputText value="#{recipeControlerBean.recipe.image}"/>
            </p:outputPanel>
            <h:commandButton styleClass="btn btn-default" value="Retour" action="#{pageManagerBean.setActivePage('recipesList.xhtml')}"/>
        </h:form>

            <p:outputPanel id="commentPanel">
                <h:form id="comments">
                    <p:dataList value="#{recipeControlerBean.recipe.listComment.commentList}" var="comm" type="ordered">
                        <p:outputPanel id="commentUser">
                            #{comm.user}
                        </p:outputPanel>

                        <p:rating value="#{comm.note}" readonly="true"/>
                        <h:outputText value="#{comm.title}"/>
                        <h:outputText value="#{comm.content}"/>
                    </p:dataList>
                    <c:choose>
                        <c:when test="#{not empty sessionScope.loggedUser}">
                            <p:rating value="#{commentSubmissionModelBean.note}"/>
                            <p:inputText value="#{commentSubmissionModelBean.title}" />
                            <p:inputTextarea value="#{commentSubmissionModelBean.content}" />
                            <p:commandButton id="btnComment" process="commentPanel" styleClass="btn btn-default" value="Commenter" update="commentPanel" actionListener="#{recipeControlerBean.addComment(commentSubmissionModelBean, sessionScope.loggedUser.idUser, sessionScope.loggedUser.login)}"/>
                        </c:when>
                        <c:otherwise>
                            <div class="alert alert-danger" role="alert">
                                Veuillez vous connecter pour ajouter des commentaires.
                            </div>
                        </c:otherwise>
                    </c:choose>
                </h:form>
            </p:outputPanel>
    </div>
</ui:composition>



